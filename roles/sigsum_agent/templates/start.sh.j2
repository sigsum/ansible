#!/bin/bash

set -eu

{% set args = '' %}
{% if sigsum_agent_soft_key is defined %}
{% set args = args + '-k "$HOME"/.config/sigsum-agent/key' %}
{% elif sigsum_agent_yubihsm_passphrase is defined %}
{% set args = args + '-a "$HOME"/.config/sigsum-agent/credentials ' %}
{% set args = args + '-i ' + sigsum_agent_yubihsm_key_id|string + ' ' %}
{% set args = args + '-c ' + sigsum_agent_yubihsm_addr|string + ':' + sigsum_agent_yubihsm_port|string %}
{% endif %}
"$HOME"/go/bin/sigsum-agent {{ args }}
